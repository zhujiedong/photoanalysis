<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R 语言分析 LI-6400 和 LI-6800 光合仪的数据</title>
  <meta name="description" content="R 语言分析 LI-6400XT 与 LI-6800 数据">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R 语言分析 LI-6400 和 LI-6800 光合仪的数据" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="R 语言分析 LI-6400XT 与 LI-6800 数据" />
  <meta name="github-repo" content="zhujiedong/R_analysis_LI-6400_LI_6800" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R 语言分析 LI-6400 和 LI-6800 光合仪的数据" />
  
  <meta name="twitter:description" content="R 语言分析 LI-6400XT 与 LI-6800 数据" />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="祝介东    北京力高泰科技有限公司">


<meta name="date" content="2018-12-25">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="batch-question.html">
<link rel="next" href="stomotal-sim.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R 光合数据分析</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="frontmatter.html"><a href="frontmatter.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="copyright.html"><a href="copyright.html"><i class="fa fa-check"></i>版权声明</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>关于作者</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> R 软件与 Rstudio</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#rsoft"><i class="fa fa-check"></i><b>1.1</b> R 软件</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#rstudiosoft"><i class="fa fa-check"></i><b>1.2</b> Rstudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="batch-question.html"><a href="batch-question.html"><i class="fa fa-check"></i><b>2</b> 批量处理光合测定数据</a><ul>
<li class="chapter" data-level="2.1" data-path="batch-question.html"><a href="batch-question.html#install_readphoto"><i class="fa fa-check"></i><b>2.1</b> 安装</a></li>
<li class="chapter" data-level="2.2" data-path="batch-question.html"><a href="batch-question.html#batch64"><i class="fa fa-check"></i><b>2.2</b> 6400 数据整合</a></li>
<li class="chapter" data-level="2.3" data-path="batch-question.html"><a href="batch-question.html#batch68"><i class="fa fa-check"></i><b>2.3</b> LI-6800 数据整合</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="response-fit.html"><a href="response-fit.html"><i class="fa fa-check"></i><b>3</b> CO<sub>2</sub> 响应曲线的拟合</a><ul>
<li class="chapter" data-level="3.1" data-path="response-fit.html"><a href="response-fit.html#fvcb_mod"><i class="fa fa-check"></i><b>3.1</b> FvCB 模型</a></li>
<li class="chapter" data-level="3.2" data-path="response-fit.html"><a href="response-fit.html#co2_note"><i class="fa fa-check"></i><b>3.2</b> CO<sub>2</sub> 响应曲线测量的注意事项</a><ul>
<li class="chapter" data-level="3.2.1" data-path="response-fit.html"><a href="response-fit.html#model_3"><i class="fa fa-check"></i><b>3.2.1</b> 分段性</a></li>
<li class="chapter" data-level="3.2.2" data-path="response-fit.html"><a href="response-fit.html#note_detail"><i class="fa fa-check"></i><b>3.2.2</b> 测量注意事项</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="response-fit.html"><a href="response-fit.html#plantecophys"><i class="fa fa-check"></i><b>3.3</b> <code>plantecophys</code> 软件包</a></li>
<li class="chapter" data-level="3.4" data-path="response-fit.html"><a href="response-fit.html#fit6400"><i class="fa fa-check"></i><b>3.4</b> LI-6400XT CO<sub>2</sub> 响应曲线的拟合</a><ul>
<li class="chapter" data-level="3.4.1" data-path="response-fit.html"><a href="response-fit.html#fitaci_intro"><i class="fa fa-check"></i><b>3.4.1</b> fitaci 函数介绍</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="response-fit.html"><a href="response-fit.html#plantecophy_use"><i class="fa fa-check"></i><b>3.5</b> 使用 <code>plantecophys</code> 拟合 LI-6400XT CO<sub>2</sub> 响应曲线数据</a><ul>
<li class="chapter" data-level="3.5.1" data-path="response-fit.html"><a href="response-fit.html#data6400"><i class="fa fa-check"></i><b>3.5.1</b> 数据的前处理</a></li>
<li class="chapter" data-level="3.5.2" data-path="response-fit.html"><a href="response-fit.html#fitaci-p"><i class="fa fa-check"></i><b>3.5.2</b> 使用示例</a></li>
<li class="chapter" data-level="3.5.3" data-path="response-fit.html"><a href="response-fit.html#onpoint_fit"><i class="fa fa-check"></i><b>3.5.3</b> 使用 ‘onepoint’ 单独计算 V<sub>cmax</sub> 和 J<sub>max</sub></a></li>
<li class="chapter" data-level="3.5.4" data-path="response-fit.html"><a href="response-fit.html#multi_curve"><i class="fa fa-check"></i><b>3.5.4</b> 多条 CO<sub>2</sub> 响应曲线的拟合</a></li>
<li class="chapter" data-level="3.5.5" data-path="response-fit.html"><a href="response-fit.html#transition"><i class="fa fa-check"></i><b>3.5.5</b> <code>findCiTransition</code> 函数</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="response-fit.html"><a href="response-fit.html#c4"><i class="fa fa-check"></i><b>3.6</b> C4 植物光合</a><ul>
<li class="chapter" data-level="3.6.1" data-path="response-fit.html"><a href="response-fit.html#c4_sim"><i class="fa fa-check"></i><b>3.6.1</b> C4 植物光合速率的计算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stomotal-sim.html"><a href="stomotal-sim.html"><i class="fa fa-check"></i><b>4</b> 气孔导度模型的拟合</a><ul>
<li class="chapter" data-level="4.1" data-path="stomotal-sim.html"><a href="stomotal-sim.html#ballberry"><i class="fa fa-check"></i><b>4.1</b> BallBerry 模型</a></li>
<li class="chapter" data-level="4.2" data-path="stomotal-sim.html"><a href="stomotal-sim.html#bbleuning"><i class="fa fa-check"></i><b>4.2</b> BBLeuning 模型</a></li>
<li class="chapter" data-level="4.3" data-path="stomotal-sim.html"><a href="stomotal-sim.html#bboptifull"><i class="fa fa-check"></i><b>4.3</b> BBOptiFull 模型</a></li>
<li class="chapter" data-level="4.4" data-path="stomotal-sim.html"><a href="stomotal-sim.html#fitbb-p"><i class="fa fa-check"></i><b>4.4</b> <code>fitBB</code> 函数</a></li>
<li class="chapter" data-level="4.5" data-path="stomotal-sim.html"><a href="stomotal-sim.html#fitbbs"><i class="fa fa-check"></i><b>4.5</b> <code>fitBBs</code> 函数</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stomotal-couple.html"><a href="stomotal-couple.html"><i class="fa fa-check"></i><b>5</b> 光合最优气孔导度耦合模型</a><ul>
<li class="chapter" data-level="5.1" data-path="stomotal-couple.html"><a href="stomotal-couple.html#farao"><i class="fa fa-check"></i><b>5.1</b> <code>FARAO</code> 函数</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="photo-stomo.html"><a href="photo-stomo.html"><i class="fa fa-check"></i><b>6</b> 光合气孔导度耦合模型</a><ul>
<li class="chapter" data-level="6.1" data-path="photo-stomo.html"><a href="photo-stomo.html#photosyn"><i class="fa fa-check"></i><b>6.1</b> <code>Photosyn</code> 函数</a><ul>
<li class="chapter" data-level="6.1.1" data-path="photo-stomo.html"><a href="photo-stomo.html#photo_exam"><i class="fa fa-check"></i><b>6.1.1</b> <code>Photosyn</code> 使用举例</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="photo-stomo.html"><a href="photo-stomo.html#photsyneb"><i class="fa fa-check"></i><b>6.2</b> <code>PhotosynEB</code> 函数</a></li>
<li class="chapter" data-level="6.3" data-path="photo-stomo.html"><a href="photo-stomo.html#photosyntuzet"><i class="fa fa-check"></i><b>6.3</b> <code>PhotosynTuzet</code> 函数</a><ul>
<li class="chapter" data-level="6.3.1" data-path="photo-stomo.html"><a href="photo-stomo.html#photosyntuzet_para"><i class="fa fa-check"></i><b>6.3.1</b> <code>PhotosynTuzet</code> 的参数</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rhtovpd.html"><a href="rhtovpd.html"><i class="fa fa-check"></i><b>7</b> RHtoVPD 函数</a></li>
<li class="chapter" data-level="8" data-path="lrc-fit.html"><a href="lrc-fit.html"><i class="fa fa-check"></i><b>8</b> 光响应曲线的拟合</a><ul>
<li class="chapter" data-level="8.1" data-path="lrc-fit.html"><a href="lrc-fit.html#rec_mod"><i class="fa fa-check"></i><b>8.1</b> 直角双曲线模型</a><ul>
<li class="chapter" data-level="8.1.1" data-path="lrc-fit.html"><a href="lrc-fit.html#rec_fit"><i class="fa fa-check"></i><b>8.1.1</b> 直角双曲线模型的实现</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="lrc-fit.html"><a href="lrc-fit.html#nonrec_mod"><i class="fa fa-check"></i><b>8.2</b> 非直角双曲线模型</a><ul>
<li class="chapter" data-level="8.2.1" data-path="lrc-fit.html"><a href="lrc-fit.html#nonrec_mode_exam"><i class="fa fa-check"></i><b>8.2.1</b> 非直角双曲线模型的实现</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="lrc-fit.html"><a href="lrc-fit.html#lrc_exp"><i class="fa fa-check"></i><b>8.3</b> 指数模型</a><ul>
<li class="chapter" data-level="8.3.1" data-path="lrc-fit.html"><a href="lrc-fit.html#lrc_exp_exam"><i class="fa fa-check"></i><b>8.3.1</b> 指数模型的实现</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="lrc-fit.html"><a href="lrc-fit.html#rev_rec"><i class="fa fa-check"></i><b>8.4</b> 直角双曲线的修正模型</a><ul>
<li class="chapter" data-level="8.4.1" data-path="lrc-fit.html"><a href="lrc-fit.html#rev_rec_exam"><i class="fa fa-check"></i><b>8.4.1</b> 直角双曲线修正模型的实现</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="start-con.html"><a href="start-con.html"><i class="fa fa-check"></i><b>9</b> 关于非线性拟合的初始值</a><ul>
<li class="chapter" data-level="9.1" data-path="start-con.html"><a href="start-con.html#nlslm"><i class="fa fa-check"></i><b>9.1</b> nlsLM 解决方案</a></li>
<li class="chapter" data-level="9.2" data-path="start-con.html"><a href="start-con.html#plot_comp"><i class="fa fa-check"></i><b>9.2</b> 作图比对法</a><ul>
<li class="chapter" data-level="9.2.1" data-path="start-con.html"><a href="start-con.html#plot_exam"><i class="fa fa-check"></i><b>9.2.1</b> 实现过程</a></li>
<li class="chapter" data-level="9.2.2" data-path="start-con.html"><a href="start-con.html#show_demo"><i class="fa fa-check"></i><b>9.2.2</b> 直观展示</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="start-con.html"><a href="start-con.html#mult_try"><i class="fa fa-check"></i><b>9.3</b> 自动多次尝试法</a></li>
<li class="chapter" data-level="9.4" data-path="start-con.html"><a href="start-con.html#sum_start"><i class="fa fa-check"></i><b>9.4</b> 小结</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="anay-6800.html"><a href="anay-6800.html"><i class="fa fa-check"></i><b>10</b> LI-6800 的数据分析</a><ul>
<li class="chapter" data-level="10.1" data-path="anay-6800.html"><a href="anay-6800.html#data6800"><i class="fa fa-check"></i><b>10.1</b> 数据格式</a></li>
<li class="chapter" data-level="10.2" data-path="anay-6800.html"><a href="anay-6800.html#dif"><i class="fa fa-check"></i><b>10.2</b> LI-6800 与 LI-6400 使用时的差别</a></li>
<li class="chapter" data-level="10.3" data-path="anay-6800.html"><a href="anay-6800.html#notice"><i class="fa fa-check"></i><b>10.3</b> 光响应曲线注意事项</a></li>
<li class="chapter" data-level="10.4" data-path="anay-6800.html"><a href="anay-6800.html#racir68"><i class="fa fa-check"></i><b>10.4</b> LI-6800 RACiR的测量与拟合</a></li>
<li class="chapter" data-level="10.5" data-path="anay-6800.html"><a href="anay-6800.html#racir_pkg"><i class="fa fa-check"></i><b>10.5</b> racir 软件包实现 RACiR数据分析</a><ul>
<li class="chapter" data-level="10.5.1" data-path="anay-6800.html"><a href="anay-6800.html#racir_pkg_real"><i class="fa fa-check"></i><b>10.5.1</b> 实现过程</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="anay-6800.html"><a href="anay-6800.html#racir68_exam"><i class="fa fa-check"></i><b>10.6</b> RACiR分析的手动实现</a></li>
<li class="chapter" data-level="10.7" data-path="anay-6800.html"><a href="anay-6800.html#fluro68"><i class="fa fa-check"></i><b>10.7</b> LI-6800 荧光数据分析</a><ul>
<li class="chapter" data-level="10.7.1" data-path="anay-6800.html"><a href="anay-6800.html#jiptest"><i class="fa fa-check"></i><b>10.7.1</b> jip test 的实现</a></li>
<li class="chapter" data-level="10.7.2" data-path="anay-6800.html"><a href="anay-6800.html#jiptest_pack"><i class="fa fa-check"></i><b>10.7.2</b> <code>jiptest</code> 软件包安装</a></li>
<li class="chapter" data-level="10.7.3" data-path="anay-6800.html"><a href="anay-6800.html#readfluor"><i class="fa fa-check"></i><b>10.7.3</b> <code>read_files</code> 及 <code>read_dcfiles</code> 函数</a></li>
<li class="chapter" data-level="10.7.4" data-path="anay-6800.html"><a href="anay-6800.html#testfluor"><i class="fa fa-check"></i><b>10.7.4</b> <code>jip_test</code> 及 <code>jip_dctest</code> 函数</a></li>
<li class="chapter" data-level="10.7.5" data-path="anay-6800.html"><a href="anay-6800.html#plotfluor"><i class="fa fa-check"></i><b>10.7.5</b> <code>jip_plot</code> 及 <code>jip_dcplot</code> 函数</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i><b>11</b> 环境与配置</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">由 bookdown 驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 语言分析 LI-6400 和 LI-6800 光合仪的数据</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="response_fit" class="section level1">
<h1><span class="header-section-number">第 3 章</span> CO<sub>2</sub> 响应曲线的拟合</h1>
<div id="fvcb_mod" class="section level2">
<h2><span class="header-section-number">3.1</span> FvCB 模型</h2>
<p>在 <code>plantecophys</code> 包中使用的模型为 <span class="citation">Farquhar, Caemmerer, and Berry (<a href="#ref-Farquhar1980A">1980</a>)</span> 建立的 C3 植物模型 FvCB，其基于 C3 植物碳反应的三个阶段：</p>
<ul>
<li><p>核酮糖-1,5-双磷酸羧化酶/加氧酶 (Rubisco)的催化下, 核酮糖-1,5-双磷酸(RuBP)与 CO<sub>2</sub>发生羧化作用, 生成3-磷酸甘油酸(PGA)。</p></li>
<li><p>在腺苷三磷酸(ATP)和还原型烟酰胺腺嘌呤 二核苷酸磷酸(NADPH)的作用下, PGA被还原成磷 酸丙糖(TP)。每6个TP中有1个输出到细胞液中, 用 于蔗糖或者淀粉的合成。</p></li>
<li><p>剩下的5个TP 在ATP的作用下再生为 3 个RuBP。一部分再生的 RuBP在Rubisco的催化下被氧化成PGA和2-磷酸乙 醇酸, 2-磷酸乙醇酸在ATP的作用下形成PGA, 并且 释放CO<sub>2</sub> (光呼吸)。</p></li>
</ul>
<p>在光照下, C3 植物净光合速率 (A) 取决于 3 个同时存在的速率: RuBP羧化速率(Vc)、RuBP氧化速率 (或光呼吸速率, Vo)和线粒体在光照下的呼吸速率 (或明呼吸速率, Rd; 此名为了与暗呼吸速率对应和区分)。RuBP氧化过程中每结合1 mol O<sub>2</sub> 就会释放 0.5 mol CO<sub>2</sub> 。因此, 净光合速率 A 的计算为：</p>
<div class="figure"><span id="fig:fvcb"></span>
<img src="images/fvcb.png" alt="光合速率的不同的限制阶段" width="100%" />
<p class="caption">
图 3.1: 光合速率的不同的限制阶段
</p>
</div>
<span class="math display" id="eq:aeta">\[\begin{equation}
A\ =V_{c}\ -0.5V_{o}\ -\ R_{d}
\tag{3.1}
\end{equation}\]</span>
<p>线粒体Rd不同于暗呼吸速率(Rn )。Rn是叶片在 黑暗中的线粒体呼吸速率, 随着光照的增加, 线粒体呼吸速率下降。因此 Rd &lt; Rn 在黑暗条件下测定的叶 片 CO<sub>2</sub> 交换速率即 Rn , 但是 Rd 的测定比较困难, 因为光照条件下 Rd 与 Vc、Vo 同时存在。<span class="citation">Hikosaka et al. (<a href="#ref-Hikosaka2006Temperature">2006</a>)</span> 总结了几种测定 Rd 的方法，式 <a href="response-fit.html#eq:aeta">(3.1)</a> 又可表达为：</p>
<span class="math display" id="eq:achange">\[\begin{equation}
A\ =V_{c}\ (1\ -0.5\alpha)\ R_{d}
\tag{3.2}
\end{equation}\]</span>
<p>式 <a href="response-fit.html#eq:achange">(3.2)</a> 中 <span class="math inline">\(\alpha\)</span> 为氧化速率和羧化速率的比值，由 Rubisco 动力学常数确定：</p>
<span class="math display" id="eq:dynamic">\[\begin{equation}
\begin{split}
\alpha &amp; =\frac{V_{O}}{V_{C}}\\
&amp; = \frac{O}{C_c} \times \frac{V_{omax} K_c}{V_{cmax}K_{o}}\\
&amp; = \frac{O}{C_{c}} \times \frac{1}{S_{\frac{c}{o}}}
\end{split}
\tag{3.3}
\end{equation}\]</span>
<p>式 <a href="response-fit.html#eq:dynamic">(3.3)</a> 中，Cc 和 O 分别为叶绿体部位 CO<sub>2</sub> 和 O<sub>2</sub> 浓度。Cc 和 O 通常以气体摩尔分数 (<span class="math inline">\(\mu mol\text{·}mol^{-1}\)</span> ) 或分压 (Pa) 表示, 但光合过程是在叶绿体的液相基质中发生的, 用分压表示更加恰当。Kc 与 Ko 为 Rubisco 羧化(氧化)的米氏常数, 代表了羧化(氧化)速率达到最大羧化(氧化)速率一半时的 CO<sub>2</sub> 和 <span class="math inline">\(O_{2}\)</span> 浓度。是 Rubisco 特异性因子, <span class="math inline">\(S_{\frac{c}{o}}\)</span>表示 Rubisco 对CO<sub>2</sub> 和 <span class="math inline">\(O_{2}\)</span> 的偏好程度。</p>
<p>当 A = Rd , 即 RuBP 羧化的 CO<sub>2</sub> 吸收速率刚好 等于 RuBP 氧化的 CO<sub>2</sub> 释放速率 (Vc = 2Vo ) 时, <span class="math inline">\(\alpha\)</span> = 0.5。此时叶绿体的 CO<sub>2</sub> 浓度就是叶绿体 CO<sub>2</sub> 光合补偿点, 标记为 <span class="math inline">\(\Gamma^{*}\)</span>。即：</p>
<span class="math display" id="eq:com">\[\begin{equation}
\Gamma^{*}\ =\ \frac{0.5O}{S_{\frac{c}{o}}}
\tag{3.4}
\end{equation}\]</span>
<p>由公式 <a href="response-fit.html#eq:dynamic">(3.3)</a>和公式 <a href="response-fit.html#eq:com">(3.4)</a>可得：</p>
<span class="math display" id="eq:combine">\[\begin{equation}
\alpha =\frac{2\Gamma^{*}}{C_{c}}
\tag{3.5}
\end{equation}\]</span>
<p>代入公式 <a href="response-fit.html#eq:achange">(3.2)</a> 得到：</p>
<span class="math display" id="eq:combine2">\[\begin{equation}
A\ =V_{c}\ (1\ -\frac{\Gamma^{*}}{C_{c}})\ R_{d}
\tag{3.6}
\end{equation}\]</span>
<p>在 Cc 浓度很低的时候，RuBP 供应充足 (图 <a href="response-fit.html#fig:fvcb">3.1</a> Rubisco 阶段)，Vc 等于 Rubisco 所能支持的羧化速率 w<sub>c</sub>，：</p>
<span class="math display" id="eq:wc">\[\begin{equation}
w_{c}\ =\ \frac{V_{cmax\ }C_{c}}{C_{c\ }+\ K_{c\ }(1\ +\ \frac{O}{K_{o}})}
\tag{3.7}
\end{equation}\]</span>
<p>随着 Cc 浓度的增加，Rubisco 支持的羧化速率超过了 RuBP 供应速率, Vc 受 RuBP 再生速率的限制（图 <a href="response-fit.html#fig:fvcb">3.1</a> RuBP 阶段），此时 Vc 由 RuBP 的再生速率限制，而 RuBP 又由电子传递速率（J）决定，故：</p>
<span class="math display" id="eq:wj">\[\begin{equation}
w_{j}\ =\ \frac{J\ C_{c}}{4C_{c\ }+\ 8\Gamma^{*}}
\tag{3.8}
\end{equation}\]</span>
<p>当 Cc 浓度很高，光合磷酸化超过了淀粉和蔗糖的合成速率的时候，Vc 受到 TP 利用速率（Vp）的限制（图 <a href="response-fit.html#fig:fvcb">3.1</a> TPU 阶段），一般情况下，</p>
<span class="math display" id="eq:wp">\[\begin{equation}
w_{p\ }=\ \frac{3V_{p}C_{c}}{C_{c}-\Gamma^{*}}
\tag{3.9}
\end{equation}\]</span>
<p>最终，C3 植物叶片的光合速率 A 由 w<sub>c</sub>、w<sub>j</sub>、w<sub>p</sub> 的最小者决定（图 <a href="response-fit.html#fig:fvcb">3.1</a> 实现部分），当c &gt; <span class="math inline">\(\Gamma^{*}\)</span>时：</p>
<span class="math display" id="eq:fvcbfin">\[\begin{equation}
A=min\{w_{c},w_{j,}w_{p}\}(1-\frac{\Gamma^{*}}{C_{c}})-R_{d}
\tag{3.10}
\end{equation}\]</span>
</div>
<div id="co2_note" class="section level2">
<h2><span class="header-section-number">3.2</span> CO<sub>2</sub> 响应曲线测量的注意事项</h2>
<p>尽管上文对其分段性做了数学上的解释，相比来讲，不是那么通俗易懂，根据 <span class="citation">Haworth, Marino, and Centritto (<a href="#ref-matthew2018">2018</a>)</span> 文章中的内容，我们后面两小节的内容对其进行概述：</p>
<div id="model_3" class="section level3">
<h3><span class="header-section-number">3.2.1</span> 分段性</h3>
<p>与光响应曲线不同， A/Ci 曲线是分段的，这也增加了其复杂性，在其最初阶段，<span class="math inline">\(CO_2\)</span> 浓度较低，在此阶段， Rubisco 更多的与 <span class="math inline">\(O_2\)</span> 结合，因此，即使是较小浓度的 <span class="math inline">\(CO_2\)</span> 的增加，也会显著提高羧化速率，我们将此阶段称之为 <span class="math inline">\(CO_2\)</span> (<span class="citation">Wullschleger (<a href="#ref-Wullschleger1993Biochemical">1993</a>)</span>) 限制或 Rubisco 限制 (<span class="citation">Long and Bernacchi (<a href="#ref-Long2003Gas">2003</a>)</span>)。净光合速率 A 与 Ci 在此阶段斜率比较陡峭，实践中往往利用计算该斜率来计算 <span class="math inline">\(V_{cmax}\)</span>。</p>
<p>在较高的 <span class="math inline">\(CO_2\)</span> 浓度下，曲线斜率开始便的平缓，作为底物的 <span class="math inline">\(CO_2\)</span> 已经不在是限制因素，随着羧化速率达到最大，RUBP 的量成为了其限制因素，而 RUBP 的再生速率受最大电子传递速率 <span class="math inline">\(J_{max}\)</span> 的限制。此时曲线的弯曲点由 <span class="math inline">\(V_{cmax}\)</span> 限制转变为 <span class="math inline">\(J_{max}\)</span>，许多研究中将饱和光下和 <span class="math inline">\(CO_2\)</span> 浓度下测量的光合速率称之为做大光合速率(<span class="citation">Heath et al. (<a href="#ref-heath2005rising">2005</a>)</span>)。而另一些研究中将最大光合速率定义为外界 <span class="math inline">\(CO_2\)</span> 时，在饱和光强下达到的最大光合速率(<span class="citation">Marshall and Biscoe (<a href="#ref-marshall1980a">1980</a>)</span>)。这些术语上的差别需要注意。</p>
<p>在之后，有可能继续观测到磷酸盐限制 RUBP 再生的情况，导致光合速率的下降。因为此时大量的磷酸丙糖与正磷酸盐结合，导致 ATP 合成受限制(<span class="citation">D. S. Ellsworth et al. (<a href="#ref-ellsworth2015phosphorus">2015</a>)</span>)。这就是 TPU 限制阶段。</p>
</div>
<div id="note_detail" class="section level3">
<h3><span class="header-section-number">3.2.2</span> 测量注意事项</h3>
<p>尽管您的操作是严格按照说明书操作的，但说明书是指仪器的正确操作方式，无法对所有测量都采用相同设置，要获得好的测量结果，有更多的因素需要注意：</p>
<p>使用 LI-6400 或 LI-6800 测量 A/Ci 曲线的过程也就是控制叶室或参比室气体浓度变化的过程，<strong>只要诱导的时间足够</strong>，气孔会在相应设置的环境条件下开到足够大，这样 Ci 会随 Ca 而变化，一般来讲二者的比例为 0.7，但也可能在 0.5~0.7 间变化。</p>
<p>一般来讲，测量参数是在温度为 25 <span class="math inline">\(^{\circ}\)</span>C 时获得，但实际测量过程中，因为外界温度过高或过低等无法控制叶室温度到 25 <span class="math inline">\(^{\circ}\)</span>C，这其实并非严重的问题，因为这可以通过数学上的方法将计算参数标准化为 25 <span class="math inline">\(^{\circ}\)</span>C 时的结果。所以，在测量时只需控制叶室温度稳定即可（通常为 20 <span class="math inline">\(^{\circ}\)</span>C ~ 30 <span class="math inline">\(^{\circ}\)</span>C 之间）。 此外就是控制恒定的 VPD 及一个饱和光强。另外就是需要注意，开始测量之前，必须在外界环境的 <span class="math inline">\(CO_2\)</span> 浓度下诱导足够长的时间，使光合速率达到稳定，一般需要20 ~ 30 min。对于没有稳定的光保护机制的植物，一般不建议在 50 ppm 或更低的浓度下进行设置，此时饱和光强和建议的温度下，植物没有足够的底物进行光合作用，这样会因为光化学反应的降低发生氧化性损伤。<span class="citation">M. Centritto, Loreto, and Chartzoulakis (<a href="#ref-centritto2003">2003</a>)</span> 研究表明，长时间的在 50 ppm 下诱导气孔打开到最大时，可以观测到最大的气孔导度（非标准方式测量）。</p>
<p>对于存在干旱胁迫的测量，由于干旱会导致气孔关闭（<span class="citation">Lauteri et al. (<a href="#ref-lauteri2014">2014</a>)</span>）, 此时没有足够多的 <span class="math inline">\(CO_2\)</span> 进入气孔，此时的测量是没有意义的，可在 50 ppm 诱导 1 h 等待气孔完全打开再快速升高 Ca 的值来进行测量（<span class="citation">M. Centritto, Loreto, and Chartzoulakis (<a href="#ref-centritto2003">2003</a>)</span>）。该方法对于 <span class="math inline">\(V_{cmax}\)</span> 不受影响而 <span class="math inline">\(J_{max}\)</span> 降低的情况适用（<span class="citation">Aganchich et al. (<a href="#ref-Aganchich2009">2009</a>)</span>）。但在某些情况下，气孔关闭速度太快，无法完成整个 A/Ci 曲线过程 (Haworth2017)（需要考虑 LI-6800 RACiR）。更重要的是，如果想采用拟合方式求 gm，那么气孔必须完全打开使叶片对 <span class="math inline">\(CO_2\)</span> 吸收的限制降到最低。对于灌溉情况良好的植物或者土壤水分情况比较好的植物，气孔不对高于外界浓度的 Ca 的升高而响应(<span class="citation">Haworth et al. (<a href="#ref-haworth2015coordination">2015</a>)</span>)，这可能需要更多的测量点或延长测量点的时间间隔来提高曲线的分辨率。另外，测量点的数量也要根据研究而改变，例如重点测量 Vcamx 时，50 ~ 300 ppm 的数据点要多一些，而如果研究对象是土壤磷酸盐对植物生理的限制，那么 1600 ~ 2000 ppm 的数据点要适当增多。</p>
<p>一个更精确的了解植物生理指标的方法是将 A/Ci 曲线改为 A/Cc 曲线，但这需要了解 gm 数据。因为 Cc 通过如下方式计算：</p>
<span class="math display" id="eq:notecc">\[\begin{equation}
C_c = C_i - \frac{A}{gm}
\tag{3.11}
\end{equation}\]</span>
<p>对于 gm 的计算，比较易操作的有几种：采用光合荧光联合测量的方式计算求得。当然也可以采用曲线拟合的方式，或者 <span class="citation">Yin et al. (<a href="#ref-yin2009using">2009</a>)</span> 使用的方式，在低氧气体下，采用不同的光照水平求得。</p>
<p>此外，测量气体交换非常重要的误差来源就是气体的扩散，因为测量时，多数时间内外界气体浓度要高于叶室内的气体浓度，那么即使使用密封性非常好的材料，由外界高 <span class="math inline">\(CO_2\)</span> 浓度气体向叶室低 <span class="math inline">\(CO_2\)</span> 浓度气体的扩散无法避免，尤其是在连续长时间测量时该效应尤为明显，因此需要经常更换叶室垫圈。具体可以通过一些方法来校正（<span class="citation">Flexas J and A (<a href="#ref-Flexas2007leak">2007</a>)</span>，rodeghiero2007major），但如果采用 LI-6800 测量这将不是问题，它采用的叶室增加技术并根据测量的漏气情况对结果自动修正。</p>
</div>
</div>
<div id="plantecophys" class="section level2">
<h2><span class="header-section-number">3.3</span> <code>plantecophys</code> 软件包</h2>
<p>Remko A. Duursma 在2015年发表了一篇文章 <span class="citation">Remko A. Duursma (<a href="#ref-Duursma2015Plantecophys">2015</a>)</span>，<code>plantecophys</code> 是其开发的一个R包工具集，用于对叶片气体交换数据进行分析和建模。实现了如下功能：</p>
<ul>
<li>CO<sub>2</sub> 响应曲线 (A-Ci curves) 的拟合、作图及模拟。</li>
<li>不同气孔导度模型。</li>
<li>根据 Cowan-Farquhar 的假设估算最适的气孔导度。</li>
<li>耦合气体交换模型的实现。</li>
<li>基于 Ci 模拟 C4 光合。</li>
<li>RHtoVPD：常用单位的转换（相对湿度、水汽压亏缺、露点温度）。</li>
</ul>
<p>各参数的基本用法请参考后文内容，或官方帮助文档:</p>
<p><a href="https://cran.r-project.org/web/packages/plantecophys/plantecophys.pdf">plantecophys</a>。</p>
</div>
<div id="fit6400" class="section level2">
<h2><span class="header-section-number">3.4</span> LI-6400XT CO<sub>2</sub> 响应曲线的拟合</h2>
<p>LI-6400XT CO<sub>2</sub> 响应曲线的拟合需要借助 <code>plantecophys</code> 的 <code>fitaci</code> 实现，fitaci 函数为根据 FvCB 模型对 A-Ci 曲线的测量数据进行拟合，并估算 J<span class="math inline">\(_{max}\)</span>、V<span class="math inline">\(_{cmax}\)</span>、R<span class="math inline">\(_{d}\)</span>及他们的标准差，并根据 <span class="citation">B. E Medlyn et al. (<a href="#ref-Medlyn2002Temperature">2002</a>)</span> 的方法考虑了温度的影响。</p>
<div id="fitaci_intro" class="section level3">
<h3><span class="header-section-number">3.4.1</span> fitaci 函数介绍</h3>
<p><code>fitaci</code> 的用法如下<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fitaci</span>(data, <span class="dt">varnames =</span> <span class="kw">list</span>(<span class="dt">ALEAF =</span> <span class="st">&quot;Photo&quot;</span>, 
  <span class="dt">Tleaf =</span> <span class="st">&quot;Tleaf&quot;</span>, <span class="dt">Ci =</span> <span class="st">&quot;Ci&quot;</span>, <span class="dt">PPFD =</span> <span class="st">&quot;PARi&quot;</span>, 
  <span class="dt">Rd =</span> <span class="st">&quot;Rd&quot;</span>), <span class="dt">Tcorrect =</span> <span class="ot">TRUE</span>, <span class="dt">Patm =</span> <span class="dv">100</span>, 
  <span class="dt">citransition =</span> <span class="ot">NULL</span>, <span class="dt">quiet =</span> <span class="ot">FALSE</span>, 
  <span class="dt">startValgrid =</span> <span class="ot">TRUE</span>, <span class="dt">fitmethod =</span> 
  <span class="kw">c</span>(<span class="st">&quot;default&quot;</span>, <span class="st">&quot;bilinear&quot;</span>, <span class="st">&quot;onepoint&quot;</span>), 
  <span class="dt">algorithm =</span> <span class="st">&quot;default&quot;</span>, <span class="dt">fitTPU =</span> <span class="ot">FALSE</span>, 
  <span class="dt">useRd =</span> <span class="ot">FALSE</span>, <span class="dt">PPFD =</span> <span class="ot">NULL</span>, <span class="dt">Tleaf =</span> <span class="ot">NULL</span>, 
  <span class="dt">alpha =</span> <span class="fl">0.24</span>, <span class="dt">theta =</span> <span class="fl">0.85</span>, <span class="dt">gmeso =</span> <span class="ot">NULL</span>, 
  <span class="dt">EaV =</span> <span class="fl">82620.87</span>, <span class="dt">EdVC =</span> <span class="dv">0</span>, <span class="dt">delsC =</span> <span class="fl">645.1013</span>,
  <span class="dt">EaJ =</span> <span class="fl">39676.89</span>, <span class="dt">EdVJ =</span> <span class="fl">2e+05</span>, 
  <span class="dt">delsJ =</span> <span class="fl">641.3615</span>, <span class="dt">GammaStar =</span> <span class="ot">NULL</span>, 
  <span class="dt">Km =</span> <span class="ot">NULL</span>, <span class="dt">id =</span> <span class="ot">NULL</span>, ...)

## S3 method for class &#39;acifit&#39;
<span class="kw">plot</span>(x, <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;model&quot;</span>, <span class="st">&quot;none&quot;</span>),
     <span class="dt">xlim =</span> <span class="ot">NULL</span>, <span class="dt">ylim =</span> <span class="ot">NULL</span>, <span class="dt">whichA =</span> <span class="kw">c</span>(
       <span class="st">&quot;Ac&quot;</span>, <span class="st">&quot;Aj&quot;</span>, <span class="st">&quot;Amin&quot;</span>, <span class="st">&quot;Ap&quot;</span>), <span class="dt">add =</span> <span class="ot">FALSE</span>,
<span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">addzeroline =</span> <span class="ot">TRUE</span>, <span class="dt">addlegend =</span> 
  <span class="op">!</span>add, <span class="dt">legendbty =</span> <span class="st">&quot;o&quot;</span>,<span class="dt">transitionpoint =</span> <span class="ot">TRUE</span>, 
<span class="dt">linecols =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>,
<span class="dv">2</span>), ...)</code></pre></div>
<p><em>主要参数注释：</em></p>
<ul>
<li>data：需要分析的数据，必须为 data.frame<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>。 格式。</li>
<li>varnames：数据的表头，此处函数默认的表头为 LI-6400 的表头，分析 LI-6400 的数据时可以不用填写，直接使用默认的参数即可<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>。</li>
<li>Tcorrect：如果为 TRUE，那么 J<span class="math inline">\(_{max}\)</span>、V<span class="math inline">\(_{cmax}\)</span> 的结果为温度校正结果，若 Tcorrect = FALSE，则为测量温度下的结果。</li>
<li>Patm：为外界大气压。</li>
<li>citransition：参见详，若提供该选项，则 J<span class="math inline">\(_{max}\)</span>、V<span class="math inline">\(_{cmax}\)</span> 的区域则分别拟合<a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>。</li>
<li>fitmethod：参见详解。</li>
<li>fitTPU：是否拟合 TPU 限制，默认为 FALSE，参见详解。</li>
<li>x：对于plot.acifit，x 为fitaci返回的对象，简单理解为 将 fitaci 函数拟合结果赋值给一个变量，此处plot函数实际上为plot.acifit。</li>
<li>what：利用基础做图工具，默认为对数据和模型进行作图。</li>
<li>whichA：默认为对所有的光合速率进行作图（Aj=Jmax-limited (蓝色), Ac=Vcmax- limited (红色), Hyperbolic minimum (黑色)), TPU-limited rate (Ap, 如果模型有计算结果）。</li>
</ul>
<p>其他参数请参考 FvCB 模型 <span class="citation">Farquhar, Caemmerer, and Berry (<a href="#ref-Farquhar1980A">1980</a>)</span> 或查看 plantecophys 的帮助文档。</p>
<div id="fitaci_detail" class="section level4">
<h4><span class="header-section-number">3.4.1.1</span> fitaci函数详解</h4>
<ul>
<li>默认为非线性拟合，详见 <span class="citation">Remko A. Duursma (<a href="#ref-Duursma2015Plantecophys">2015</a>)</span>。</li>
<li>bilinear 方法使用两次线性拟合方法首先拟合 V<span class="math inline">\(_{cmax}\)</span> 和 R<span class="math inline">\(_{d}\)</span>，然后在拟合J<span class="math inline">\(_{max}\)</span>，过渡点的选择为对所有数据拟合最适的点，类似 <span class="citation">Gu et al. (<a href="#ref-Gu2010Reliable">2010</a>)</span> 的方法。该方法的优势时无论如何，都会返回拟合结果，尤其是非线性拟合失败时使用该方法，但若默认方法失败时，需首先检查是否数据存在问题。两种拟合方法的结果有轻微的差别<a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>。</li>
<li>onepoint 参考 <span class="citation">De Kauwe et al. (<a href="#ref-De2016A">2016</a>)</span>。</li>
<li><p>citransition 使用时，数据将被区分为 V<span class="math inline">\(_{cmax}\)</span> 限制（Ci &lt; citransition ）区域，以及 J<span class="math inline">\(_{max}\)</span> 限制 (Ci &gt; citransition) 区域。</p></li>
<li><p>fitTPU：如果要计算TPU，要设置 fitTPU = TRUE，并且 fittingmethod = “bilinear”。但需要注意，当 TPU 被计算时，没有 J<span class="math inline">\(_{max}\)</span> 限制的点的存在是可能的。TPU限制的发生是在A值不随 CO<span class="math inline">\(_{2}\)</span> 的增加而增加时发生的，因此计算 TPU 是否有返回值，取决于测量数据是否有此情况出现。</p></li>
</ul>
</div>
</div>
</div>
<div id="plantecophy_use" class="section level2">
<h2><span class="header-section-number">3.5</span> 使用 <code>plantecophys</code> 拟合 LI-6400XT CO<sub>2</sub> 响应曲线数据</h2>
<div id="data6400" class="section level3">
<h3><span class="header-section-number">3.5.1</span> 数据的前处理</h3>
<p>虽然 R 软件支持直接导入 xlsx 的数据，但因为 LI-6400XT 的数据记录文件内有其他空行或 remark 等内容，增加了处理代码的量，<strong>故而推荐将其数据先整理为如表 <a href="response-fit.html#tab:head6400">3.1</a> 样式，并另存为 csv 格式</strong><a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a>：</p>
<table>
<caption><span id="tab:head6400">表 3.1: </span>推荐 LI-6400 整理后数据样式</caption>
<thead>
<tr class="header">
<th align="right">Obs</th>
<th align="left">HHMMSS</th>
<th align="right">FTime</th>
<th align="right">EBal.</th>
<th align="right">Photo</th>
<th align="right">Cond</th>
<th align="right">Ci</th>
<th align="right">Trmmol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">15:46:59</td>
<td align="right">271.5</td>
<td align="right">0</td>
<td align="right">14.2848912</td>
<td align="right">0.2730691</td>
<td align="right">286.39751</td>
<td align="right">2.226126</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">15:48:26</td>
<td align="right">358.0</td>
<td align="right">0</td>
<td align="right">10.6562220</td>
<td align="right">0.2826303</td>
<td align="right">217.32002</td>
<td align="right">2.292845</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">15:49:54</td>
<td align="right">446.0</td>
<td align="right">0</td>
<td align="right">6.4525814</td>
<td align="right">0.2909460</td>
<td align="right">150.67623</td>
<td align="right">2.361704</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">15:51:26</td>
<td align="right">538.5</td>
<td align="right">0</td>
<td align="right">1.7971569</td>
<td align="right">0.3057164</td>
<td align="right">85.82530</td>
<td align="right">2.459459</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">15:52:54</td>
<td align="right">626.5</td>
<td align="right">0</td>
<td align="right">-0.6575974</td>
<td align="right">0.3150002</td>
<td align="right">53.47985</td>
<td align="right">2.515992</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">15:54:50</td>
<td align="right">742.5</td>
<td align="right">0</td>
<td align="right">15.4296572</td>
<td align="right">0.3255415</td>
<td align="right">292.56161</td>
<td align="right">2.579840</td>
</tr>
</tbody>
</table>
</div>
<div id="fitaci-p" class="section level3">
<h3><span class="header-section-number">3.5.2</span> 使用示例</h3>
<p><code>plantecophys</code> 并非 base 的安装包，首次使用需要从 <code>CRAN</code> 安装，可以使用图形界面安装，也可以直接用命令行安装<a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a>，推荐同时安装依赖。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;plantecophys&quot;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 载入 plantecophys </span>
<span class="kw">library</span>(<span class="st">&quot;plantecophys&quot;</span>)

<span class="co"># 利用read.csv读取数据文件，</span>
<span class="co"># 我的路径为当前工作路径的data文件夹内</span>
aci &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/aci.csv&quot;</span>)

<span class="co"># 防止可能出现的NA值</span>
aci &lt;-<span class="st"> </span><span class="kw">subset</span>(aci, Obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)

<span class="co"># 不修改默认参数对数据进行拟合</span>
acifit &lt;-<span class="st"> </span><span class="kw">fitaci</span>(aci)
<span class="co"># 查看拟合结果的参数名称，方便导出数据使用</span>
<span class="kw">attributes</span>(acifit)</code></pre></div>
<pre><code>## $names
##  [1] &quot;df&quot;             &quot;pars&quot;           &quot;nlsfit&quot;         &quot;Tcorrect&quot;      
##  [5] &quot;Photosyn&quot;       &quot;Ci_transition&quot;  &quot;Ci_transition2&quot; &quot;Rd_measured&quot;   
##  [9] &quot;GammaStar&quot;      &quot;Km&quot;             &quot;kminput&quot;        &quot;gstarinput&quot;    
## [13] &quot;fitmethod&quot;      &quot;citransition&quot;   &quot;gmeso&quot;          &quot;fitTPU&quot;        
## [17] &quot;alphag&quot;         &quot;RMSE&quot;           &quot;runorder&quot;      
## 
## $class
## [1] &quot;acifit&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 查看拟合结果</span>
<span class="kw">summary</span>(acifit)</code></pre></div>
<pre><code>## Result of fitaci.
## 
## Data and predictions:
##            Ci      Ameas     Amodel         Ac        Aj   Ap       Rd VPD
## 5    53.47985 -0.6575974 -0.5146882 -0.3552036  0.000000 1000 0.159449 1.5
## 4    85.82530  1.7971569  1.9292621  2.0888575  5.068534 1000 0.159449 1.5
## 3   150.67623  6.4525814  6.4176037  6.5777528 12.755502 1000 0.159449 1.5
## 2   217.32002 10.6562220 10.5354626 10.6965875 17.519644 1000 0.159449 1.5
## 1   286.39751 14.2848912 14.3365887 14.4993980 20.749310 1000 0.159449 1.5
## 6   292.56161 15.4296572 14.9749157 15.1383702 20.852616 1000 0.159449 1.5
## 7   292.96456 15.7134791 15.0564801 15.2200522 20.831098 1000 0.159449 1.5
## 8   450.64285 22.2659015 23.0115187 23.1975997 25.186939 3000 0.159449 1.5
## 9   622.03873 26.5135040 27.6485003 30.4281393 27.837462 3000 0.159449 1.5
## 10  992.08737 30.3898585 30.6300461 42.3998173 30.797660 3000 0.159449 1.5
## 11 1558.96968 33.6267056 32.6638021 54.9948264 32.828110 3000 0.159449 1.5
## 12 1756.16396 33.3152783 33.0981490 58.5844507 33.261965 3000 0.159449 1.5
##       Tleaf         Cc     PPFD Patm Ci_original
## 5  31.12332   53.47934 1800.490  100    53.47985
## 4  30.99093   85.82723 1800.558  100    85.82530
## 3  30.82872  150.68265 1800.140  100   150.67623
## 2  30.63983  217.33057 1800.524  100   217.32002
## 1  30.46890  286.41186 1800.701  100   286.39751
## 6  31.26338  292.57660 1799.923  100   292.56161
## 7  31.41866  292.97963 1799.975  100   292.96456
## 8  31.54122  450.66588 1799.826  100   450.64285
## 9  31.63493  622.06640 1799.578  100   622.03873
## 10 31.73910  992.11803 1800.055  100   992.08737
## 11 31.86938 1559.00238 1800.022  100  1558.96968
## 12 31.96654 1756.19709 1799.585  100  1756.16396
## 
## Root mean squared error:  1.889701 
## 
## Estimated parameters:
##         Estimate Std. Error
## Vcmax  49.261616  1.5152405
## Jmax  126.620537  2.2816267
## Rd      0.159449  0.4001302
## Note: Vcmax, Jmax are at 25C, Rd is at measurement T.
## 
## Curve was fit using method:  default 
## 
## Parameter settings:
## Patm = 100
##  alpha = 0.24
##  theta = 0.85
##  EaV = 82620.87
##  EdVC = 0
##  delsC = 645.1013
##  EaJ = 39676.89
##  EdVJ = 2e+05
##  delsJ = 641.3615
## 
## Estimated from Tleaf (shown at mean Tleaf):
## GammaStar =  58.61138 
## Km =  1223.279</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">acifit_linear &lt;-<span class="st"> </span><span class="kw">fitaci</span>(aci,  <span class="dt">fitmethod =</span> <span class="st">&quot;bilinear&quot;</span>)
<span class="kw">summary</span>(acifit_linear)</code></pre></div>
<pre><code>## Result of fitaci.
## 
## Data and predictions:
##            Ci      Ameas     Amodel         Ac        Aj   Ap        Rd
## 5    53.47985 -0.6575974 -0.7389447 -0.3560483  0.000000 1000 0.3828608
## 4    85.82530  1.7971569  1.7108198  2.0938246  5.138366 1000 0.3828608
## 3   150.67623  6.4525814  6.2098476  6.5933940 12.931333 1000 0.3828608
## 2   217.32002 10.6562220 10.3375299 10.7220229 17.761317 1000 0.3828608
## 1   286.39751 14.2848912 14.1477696 14.5338762 21.035722 1000 0.3828608
## 6   292.56161 15.4296572 14.7876514 15.1743678 21.139657 1000 0.3828608
## 7   292.96456 15.7134791 14.8694171 15.2562440 21.117718 1000 0.3828608
## 8   450.64285 22.2659015 22.8464806 23.2527613 25.533374 3000 0.3828608
## 9   622.03873 26.5135040 27.8030690 30.5004944 28.220254 3000 0.3828608
## 10  992.08737 30.3898585 30.8295808 42.5006398 31.221072 3000 0.3828608
## 11 1558.96968 33.6267056 32.8913778 55.1255986 33.279305 3000 0.3828608
## 12 1756.16396 33.3152783 33.3316070 58.7237587 33.719013 3000 0.3828608
##    VPD    Tleaf         Cc     PPFD Patm Ci_original
## 5  1.5 31.12332   53.47911 1800.490  100    53.47985
## 4  1.5 30.99093   85.82701 1800.558  100    85.82530
## 3  1.5 30.82872  150.68244 1800.140  100   150.67623
## 2  1.5 30.63983  217.33037 1800.524  100   217.32002
## 1  1.5 30.46890  286.41167 1800.701  100   286.39751
## 6  1.5 31.26338  292.57641 1799.923  100   292.56161
## 7  1.5 31.41866  292.97944 1799.975  100   292.96456
## 8  1.5 31.54122  450.66572 1799.826  100   450.64285
## 9  1.5 31.63493  622.06656 1799.578  100   622.03873
## 10 1.5 31.73910  992.11823 1800.055  100   992.08737
## 11 1.5 31.86938 1559.00260 1800.022  100  1558.96968
## 12 1.5 31.96654 1756.19733 1799.585  100  1756.16396
## 
## Root mean squared error:  2.013045 
## 
## Estimated parameters:
##          Estimate Std. Error
## Vcmax  49.3787547  3.4815555
## Jmax  128.5546403         NA
## Rd      0.3828608  0.4697008
## Note: Vcmax, Jmax are at 25C, Rd is at measurement T.
## 
## Curve was fit using method:  bilinear 
## 
## Parameter settings:
## Patm = 100
##  alpha = 0.24
##  theta = 0.85
##  EaV = 82620.87
##  EdVC = 0
##  delsC = 645.1013
##  EaJ = 39676.89
##  EdVJ = 2e+05
##  delsJ = 641.3615
## 
## Estimated from Tleaf (shown at mean Tleaf):
## GammaStar =  58.61138 
## Km =  1223.279</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 仅查看拟合参数, 比较两种拟合参数的差异</span>
<span class="kw">coef</span>(acifit_linear)</code></pre></div>
<pre><code>##       Vcmax        Jmax          Rd 
##  49.3787547 128.5546403   0.3828608</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coef</span>(acifit)</code></pre></div>
<pre><code>##      Vcmax       Jmax         Rd 
##  49.261616 126.620537   0.159449</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 设置作图参数，图形的边距及分为1行两列输出图形</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="co"># 对两种拟合参数的结果作图，查看模型拟合是否正常</span>
<span class="kw">plot</span>(acifit, <span class="dt">addlegend =</span> <span class="ot">FALSE</span>)
<span class="kw">legend</span>(<span class="dt">x =</span> <span class="dv">500</span>, <span class="dt">y =</span> <span class="dv">10</span>, 
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(A[c])), 
                <span class="kw">expression</span>(<span class="kw">paste</span>(A[j])),
                <span class="st">&quot;Limiting rate&quot;</span>),
       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),
       <span class="dt">col =</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>) 
         )
<span class="kw">mtext</span>(<span class="st">&quot; fitmethod = &#39;default&#39; &quot;</span>)

<span class="kw">plot</span>(acifit_linear, <span class="dt">addlegend =</span> <span class="ot">FALSE</span>)
<span class="kw">legend</span>(<span class="dt">x =</span> <span class="dv">500</span>, <span class="dt">y =</span> <span class="dv">10</span>, 
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(A[c])), 
                  <span class="kw">expression</span>(<span class="kw">paste</span>(A[j])),
                  <span class="st">&quot;Limiting rate&quot;</span>),
       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),
       <span class="dt">col =</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>) 
)
<span class="kw">mtext</span>(<span class="st">&quot;fitmethod = &#39;bilinear&#39; &quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:fitaci6400"></span>
<img src="bookdown_files/figure-html/fitaci6400-1.png" alt="光合速率的不同的限制阶段" width="672" />
<p class="caption">
图 3.2: 光合速率的不同的限制阶段
</p>
</div>
<p>如果需要导出数据做他用，直接根据 <code>attributes</code> 中看到的名称，选择对应的数据导出即可，如果使用 Rstudio 的话，其自动补全的功能在选择数据上更方便。例如导出预测值和系数分别使用如下方式：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 将模型拟合结果中df（即计算数据）赋给predictaci，</span>
<span class="co"># 并用write.csv导出</span>
predictaci &lt;-<span class="st"> </span>acifit<span class="op">$</span>df
<span class="kw">write.csv</span>(acifit<span class="op">$</span>df, <span class="dt">file =</span> <span class="st">&quot;acipredict.csv&quot;</span>)
<span class="kw">write.csv</span>(<span class="kw">coef</span>(acifit), <span class="dt">file =</span> <span class="st">&quot;coefaci.csv&quot;</span>)</code></pre></div>
<blockquote>
<p>需要注意的是，因为非线性拟合需要一个初始值，因此，使用默认方式（非线性拟合）的时候，会存在可能的拟合失败现象，此时可以使用 <code>fitmethod = &quot;bilinear&quot;</code>，二者结果略有差别。</p>
</blockquote>
<div id="onepoint" class="section level4">
<h4><span class="header-section-number">3.5.2.1</span> fitmethod = “onepoint” 介绍</h4>
<p><span class="citation">De Kauwe et al. (<a href="#ref-De2016A">2016</a>)</span> 发表了关于 one point 方法计算 <span class="math inline">\(V_{cmax}\)</span> 和 <span class="math inline">\(J_{max}\)</span> 方法的文章，在 2017 年 11 月的更新中，plantecophys 增加了响应的 R 软件实现方法， 该方法并非使用一个点计算 <span class="math inline">\(V_{cmax}\)</span> 和 <span class="math inline">\(J_{max}\)</span>，而是对数据集中的每一个点的值进行估计，使用的方法为逆向了光合作用方程。输出为对每个原始数据加入了 <span class="math inline">\(V_{cmax}\)</span> 和 <span class="math inline">\(J_{max}\)</span>，当然一如既往的可以使用温度校准的方法。<strong>并不建议该方法应用于整个 ACi 曲线的数据，它的假设是在外部环境 CO<sub>2</sub> 浓度和饱和光下，受到 Rubisco 所化速率的限制而不是 RUBP 的限制。</strong></p>
<p>基于上面的描述，他们的模型如下：</p>
<span class="math display" id="eq:inverseA">\[\begin{equation}
\hat{V}_{cmax} = (A_{sat} + R_{day}) \frac{C_i + K_m}{C_i - \Gamma^*} 
\tag{3.12}
\end{equation}\]</span>
<p>其中：K<sub>m</sub> 为米氏常数，其计算为：</p>
<span class="math display" id="eq:km">\[\begin{equation}
K_m = K_c (1 + \frac{O_i}{K_o}) 
\tag{3.13}
\end{equation}\]</span>
<p>未知参数均由文献中的方法进行计算，具体可参考 <span class="citation">De Kauwe et al. (<a href="#ref-De2016A">2016</a>)</span> 的原文,但上述方法的缺陷为还要使用 ACi 曲线来估算 R<sub>day</sub>，因此作者使用了1.5% V<sub>cmax</sub> 作为 R<sub>day</sub>，因此公式 <a href="response-fit.html#eq:inverseA">(3.12)</a> 可变换为：</p>
<span class="math display" id="eq:onepoint">\[\begin{equation}
\hat{V}_{cmax} = A_{sat} (\frac{C_i + K_m}{C_i - \Gamma^*} - 0.015)
\tag{3.14}
\end{equation}\]</span>
<p>另一个重要的模型的假设为 J<sub>max</sub> 与 V<sub>cmax</sub> 是成比例的， J<sub>max</sub> 的计算是通过 C<sub>i</sub> transition point 来实现的，文章中的比值均值为 1.9，范围在 1.68 ~ 2.14 之间。</p>
</div>
</div>
<div id="onpoint_fit" class="section level3">
<h3><span class="header-section-number">3.5.3</span> 使用 ‘onepoint’ 单独计算 V<sub>cmax</sub> 和 J<sub>max</sub></h3>
<p>目前我手头没有相应数据，仅有使用 LI-6400 测试 auto log 2 时的一个数据，我们用这个来示范该方法的使用：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">one_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/onepoint.csv&quot;</span>)
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(one_data), <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,
             <span class="dt">caption =</span> <span class="st">&#39;onepoint 使用的数据&#39;</span>)</code></pre></div>
<table>
<caption><span id="tab:onepointdata">表 3.2: </span>onepoint 使用的数据</caption>
<thead>
<tr class="header">
<th align="right">Obs</th>
<th align="left">HHMMSS</th>
<th align="right">FTime</th>
<th align="right">EBal.</th>
<th align="right">Photo</th>
<th align="right">Cond</th>
<th align="right">Ci</th>
<th align="right">Trmmol</th>
<th align="right">VpdL</th>
<th align="right">CTleaf</th>
<th align="right">Area</th>
<th align="right">BLC_1</th>
<th align="right">StmRat</th>
<th align="right">BLCond</th>
<th align="right">Tair</th>
<th align="right">Tleaf</th>
<th align="right">TBlk</th>
<th align="right">CO2R</th>
<th align="right">CO2S</th>
<th align="right">H2OR</th>
<th align="right">H2OS</th>
<th align="right">RH_R</th>
<th align="right">RH_S</th>
<th align="right">Flow</th>
<th align="right">PARi</th>
<th align="right">PARo</th>
<th align="right">Press</th>
<th align="right">CsMch</th>
<th align="right">HsMch</th>
<th align="right">CsMchSD</th>
<th align="right">HsMchSD</th>
<th align="right">CrMchSD</th>
<th align="right">HrMchSD</th>
<th align="right">StableF</th>
<th align="right">BLCslope</th>
<th align="right">BLCoffst</th>
<th align="right">f_parin</th>
<th align="right">f_parout</th>
<th align="right">alphaK</th>
<th align="right">Status</th>
<th align="right">fda</th>
<th align="right">Trans</th>
<th align="right">Tair_K</th>
<th align="right">Twall_K</th>
<th align="right">R.W.m2.</th>
<th align="right">Tl.Ta</th>
<th align="right">SVTleaf</th>
<th align="right">h2o_i</th>
<th align="right">h20diff</th>
<th align="right">CTair</th>
<th align="right">SVTair</th>
<th align="right">CndTotal</th>
<th align="right">vp_kPa</th>
<th align="right">VpdA</th>
<th align="right">CndCO2</th>
<th align="right">Ci_Pa</th>
<th align="right">Ci.Ca</th>
<th align="right">RHsfc</th>
<th align="right">C2sfc</th>
<th align="right">AHs.Cs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">14:12:43</td>
<td align="right">347.0</td>
<td align="right">0</td>
<td align="right">10.519216</td>
<td align="right">0.1369336</td>
<td align="right">263.0905</td>
<td align="right">1.963046</td>
<td align="right">1.445782</td>
<td align="right">25.89411</td>
<td align="right">6</td>
<td align="right">1.42</td>
<td align="right">1</td>
<td align="right">2.84</td>
<td align="right">25.86572</td>
<td align="right">25.89411</td>
<td align="right">25.86697</td>
<td align="right">412.5374</td>
<td align="right">398.9832</td>
<td align="right">16.98853</td>
<td align="right">19.29724</td>
<td align="right">50.16200</td>
<td align="right">56.97891</td>
<td align="right">500.3231</td>
<td align="right">1198.761</td>
<td align="right">7.497697</td>
<td align="right">98.84273</td>
<td align="right">2.011996</td>
<td align="right">-0.3824501</td>
<td align="right">0.1618589</td>
<td align="right">0.0039255</td>
<td align="right">0.1864786</td>
<td align="right">0.0030409</td>
<td align="right">1.0000000</td>
<td align="right">-0.2195652</td>
<td align="right">2.737392</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.16</td>
<td align="right">111115</td>
<td align="right">0.8338718</td>
<td align="right">0.0019630</td>
<td align="right">299.0441</td>
<td align="right">299.0157</td>
<td align="right">191.8018</td>
<td align="right">1.191025</td>
<td align="right">3.353173</td>
<td align="right">33.92433</td>
<td align="right">14.62709</td>
<td align="right">25.87991</td>
<td align="right">3.350355</td>
<td align="right">0.1306349</td>
<td align="right">1.907392</td>
<td align="right">1.442964</td>
<td align="right">0.0821903</td>
<td align="right">26.00458</td>
<td align="right">0.6594024</td>
<td align="right">57.74196</td>
<td align="right">393.9829</td>
<td align="right">0.0154169</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">14:13:04</td>
<td align="right">369.0</td>
<td align="right">0</td>
<td align="right">10.361122</td>
<td align="right">0.1357092</td>
<td align="right">264.1135</td>
<td align="right">1.946022</td>
<td align="right">1.445559</td>
<td align="right">25.89542</td>
<td align="right">6</td>
<td align="right">1.42</td>
<td align="right">1</td>
<td align="right">2.84</td>
<td align="right">25.86854</td>
<td align="right">25.89542</td>
<td align="right">25.86977</td>
<td align="right">412.5459</td>
<td align="right">399.1890</td>
<td align="right">17.01363</td>
<td align="right">19.30231</td>
<td align="right">50.22723</td>
<td align="right">56.98380</td>
<td align="right">500.3223</td>
<td align="right">1198.748</td>
<td align="right">7.486364</td>
<td align="right">98.84175</td>
<td align="right">2.018435</td>
<td align="right">-0.3787848</td>
<td align="right">0.2174792</td>
<td align="right">0.0025482</td>
<td align="right">0.2455426</td>
<td align="right">0.0025012</td>
<td align="right">1.0000000</td>
<td align="right">-0.2195652</td>
<td align="right">2.737392</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.16</td>
<td align="right">111115</td>
<td align="right">0.8338705</td>
<td align="right">0.0019460</td>
<td align="right">299.0454</td>
<td align="right">299.0185</td>
<td align="right">191.7997</td>
<td align="right">1.199722</td>
<td align="right">3.353433</td>
<td align="right">33.92729</td>
<td align="right">14.62498</td>
<td align="right">25.88198</td>
<td align="right">3.350765</td>
<td align="right">0.1295200</td>
<td align="right">1.907874</td>
<td align="right">1.442891</td>
<td align="right">0.0814842</td>
<td align="right">26.10544</td>
<td align="right">0.6616252</td>
<td align="right">57.73418</td>
<td align="right">394.2638</td>
<td align="right">0.0151724</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">14:13:25</td>
<td align="right">373.0</td>
<td align="right">0</td>
<td align="right">10.207166</td>
<td align="right">0.1342114</td>
<td align="right">264.8348</td>
<td align="right">1.925734</td>
<td align="right">1.445717</td>
<td align="right">25.89660</td>
<td align="right">6</td>
<td align="right">1.42</td>
<td align="right">1</td>
<td align="right">2.84</td>
<td align="right">25.87186</td>
<td align="right">25.89660</td>
<td align="right">25.87317</td>
<td align="right">412.5393</td>
<td align="right">399.3762</td>
<td align="right">17.03833</td>
<td align="right">19.30316</td>
<td align="right">50.29006</td>
<td align="right">56.97489</td>
<td align="right">500.3188</td>
<td align="right">1198.737</td>
<td align="right">7.489428</td>
<td align="right">98.84142</td>
<td align="right">2.018435</td>
<td align="right">-0.3787848</td>
<td align="right">0.2174792</td>
<td align="right">0.0025482</td>
<td align="right">0.2455426</td>
<td align="right">0.0025012</td>
<td align="right">1.0000000</td>
<td align="right">-0.2195652</td>
<td align="right">2.737392</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.16</td>
<td align="right">111115</td>
<td align="right">0.8338647</td>
<td align="right">0.0019257</td>
<td align="right">299.0466</td>
<td align="right">299.0219</td>
<td align="right">191.7980</td>
<td align="right">1.210137</td>
<td align="right">3.353668</td>
<td align="right">33.92979</td>
<td align="right">14.62663</td>
<td align="right">25.88423</td>
<td align="right">3.351212</td>
<td align="right">0.1281551</td>
<td align="right">1.907951</td>
<td align="right">1.443261</td>
<td align="right">0.0806199</td>
<td align="right">26.17665</td>
<td align="right">0.6631213</td>
<td align="right">57.71117</td>
<td align="right">394.5242</td>
<td align="right">0.0149311</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">14:13:41</td>
<td align="right">389.5</td>
<td align="right">0</td>
<td align="right">9.547416</td>
<td align="right">0.1281947</td>
<td align="right">269.6337</td>
<td align="right">1.854272</td>
<td align="right">1.454248</td>
<td align="right">25.94020</td>
<td align="right">6</td>
<td align="right">1.42</td>
<td align="right">1</td>
<td align="right">2.84</td>
<td align="right">25.91845</td>
<td align="right">25.94020</td>
<td align="right">25.92104</td>
<td align="right">413.8090</td>
<td align="right">401.4666</td>
<td align="right">17.12559</td>
<td align="right">19.30638</td>
<td align="right">50.40359</td>
<td align="right">56.82203</td>
<td align="right">500.3162</td>
<td align="right">1199.245</td>
<td align="right">7.449210</td>
<td align="right">98.83208</td>
<td align="right">2.018435</td>
<td align="right">-0.3787848</td>
<td align="right">0.2174792</td>
<td align="right">0.0025482</td>
<td align="right">0.2455426</td>
<td align="right">0.0025012</td>
<td align="right">1.0000000</td>
<td align="right">-0.2195652</td>
<td align="right">2.737392</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.16</td>
<td align="right">111115</td>
<td align="right">0.8338604</td>
<td align="right">0.0018543</td>
<td align="right">299.0902</td>
<td align="right">299.0684</td>
<td align="right">191.8792</td>
<td align="right">1.247158</td>
<td align="right">3.362337</td>
<td align="right">34.02071</td>
<td align="right">14.71433</td>
<td align="right">25.92933</td>
<td align="right">3.360173</td>
<td align="right">0.1226580</td>
<td align="right">1.908089</td>
<td align="right">1.452084</td>
<td align="right">0.0771402</td>
<td align="right">26.64846</td>
<td align="right">0.6716216</td>
<td align="right">57.48324</td>
<td align="right">396.9282</td>
<td align="right">0.0138266</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">14:16:16</td>
<td align="right">540.0</td>
<td align="right">0</td>
<td align="right">10.288968</td>
<td align="right">0.1376602</td>
<td align="right">267.9198</td>
<td align="right">2.009217</td>
<td align="right">1.471788</td>
<td align="right">26.01813</td>
<td align="right">6</td>
<td align="right">1.42</td>
<td align="right">1</td>
<td align="right">2.84</td>
<td align="right">26.01478</td>
<td align="right">26.01813</td>
<td align="right">26.02164</td>
<td align="right">413.9044</td>
<td align="right">400.5999</td>
<td align="right">16.92567</td>
<td align="right">19.28878</td>
<td align="right">49.53554</td>
<td align="right">56.44850</td>
<td align="right">500.3043</td>
<td align="right">1200.785</td>
<td align="right">7.497018</td>
<td align="right">98.81870</td>
<td align="right">2.018435</td>
<td align="right">-0.3787848</td>
<td align="right">0.2174792</td>
<td align="right">0.0025482</td>
<td align="right">0.2455426</td>
<td align="right">0.0025012</td>
<td align="right">0.6666667</td>
<td align="right">-0.2195652</td>
<td align="right">2.737392</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.16</td>
<td align="right">111115</td>
<td align="right">0.8338405</td>
<td align="right">0.0020092</td>
<td align="right">299.1681</td>
<td align="right">299.1648</td>
<td align="right">192.1257</td>
<td align="right">1.174669</td>
<td align="right">3.377880</td>
<td align="right">34.18260</td>
<td align="right">14.89382</td>
<td align="right">26.01646</td>
<td align="right">3.377546</td>
<td align="right">0.1312960</td>
<td align="right">1.906093</td>
<td align="right">1.471453</td>
<td align="right">0.0826090</td>
<td align="right">26.47549</td>
<td align="right">0.6687965</td>
<td align="right">57.30143</td>
<td align="right">395.7090</td>
<td align="right">0.0148991</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">14:16:32</td>
<td align="right">555.5</td>
<td align="right">0</td>
<td align="right">10.178603</td>
<td align="right">0.1381995</td>
<td align="right">269.5898</td>
<td align="right">2.016100</td>
<td align="right">1.471138</td>
<td align="right">26.01657</td>
<td align="right">6</td>
<td align="right">1.42</td>
<td align="right">1</td>
<td align="right">2.84</td>
<td align="right">26.02212</td>
<td align="right">26.01657</td>
<td align="right">26.02939</td>
<td align="right">413.6639</td>
<td align="right">400.4885</td>
<td align="right">16.92345</td>
<td align="right">19.29468</td>
<td align="right">49.49181</td>
<td align="right">56.42595</td>
<td align="right">500.2979</td>
<td align="right">1200.879</td>
<td align="right">7.569045</td>
<td align="right">98.80596</td>
<td align="right">2.018435</td>
<td align="right">-0.3787848</td>
<td align="right">0.2174792</td>
<td align="right">0.0025482</td>
<td align="right">0.2455426</td>
<td align="right">0.0025012</td>
<td align="right">0.6666667</td>
<td align="right">-0.2195652</td>
<td align="right">2.737392</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.16</td>
<td align="right">111115</td>
<td align="right">0.8338298</td>
<td align="right">0.0020161</td>
<td align="right">299.1666</td>
<td align="right">299.1721</td>
<td align="right">192.1406</td>
<td align="right">1.172561</td>
<td align="right">3.377567</td>
<td align="right">34.18384</td>
<td align="right">14.88916</td>
<td align="right">26.01934</td>
<td align="right">3.378122</td>
<td align="right">0.1317865</td>
<td align="right">1.906429</td>
<td align="right">1.471693</td>
<td align="right">0.0829197</td>
<td align="right">26.63708</td>
<td align="right">0.6731525</td>
<td align="right">57.32389</td>
<td align="right">395.6501</td>
<td align="right">0.0147473</td>
</tr>
</tbody>
</table>
<p>数据如上所示，为同一个叶片连续记录数据，故所有的光合速率十分接近。</p>
<p>使用方法：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plantecophys)

one_data &lt;-<span class="st"> </span><span class="kw">subset</span>(one_data, Obs <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
one_data<span class="op">$</span>Rd &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="kw">length</span>(one_data<span class="op">$</span>Obs))
aci_fit &lt;-<span class="st"> </span><span class="kw">fitaci</span>(one_data, <span class="dt">fitmethod =</span> <span class="st">&quot;onepoint&quot;</span>)

knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(<span class="kw">data.frame</span>(aci_fit<span class="op">$</span>Photo, 
             aci_fit<span class="op">$</span>Vcmax, aci_fit<span class="op">$</span>Jmax)),
             <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,
             <span class="dt">caption =</span> <span class="st">&#39;onepoint 法计算的结果&#39;</span>)</code></pre></div>
<table>
<caption><span id="tab:onepoint">表 3.3: </span>onepoint 法计算的结果</caption>
<thead>
<tr class="header">
<th align="right">aci_fit.Photo</th>
<th align="right">aci_fit.Vcmax</th>
<th align="right">aci_fit.Jmax</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10.519216</td>
<td align="right">47.06893</td>
<td align="right">71.73759</td>
</tr>
<tr class="even">
<td align="right">10.361122</td>
<td align="right">46.22091</td>
<td align="right">70.51059</td>
</tr>
<tr class="odd">
<td align="right">10.207166</td>
<td align="right">45.44617</td>
<td align="right">69.35838</td>
</tr>
<tr class="even">
<td align="right">9.547416</td>
<td align="right">41.86217</td>
<td align="right">64.24400</td>
</tr>
<tr class="odd">
<td align="right">10.288968</td>
<td align="right">45.09335</td>
<td align="right">69.36954</td>
</tr>
<tr class="even">
<td align="right">10.178603</td>
<td align="right">44.37360</td>
<td align="right">68.41628</td>
</tr>
</tbody>
</table>
<p>需要注意，为保证结果的精确，如果不设定 Rd, 也即文献中的 Rday， 模型是无法计算的，因此上面的示例中虚构了一个，实际操作用一般使用标准的 ACi 测量计算。</p>
</div>
<div id="multi_curve" class="section level3">
<h3><span class="header-section-number">3.5.4</span> 多条 CO<sub>2</sub> 响应曲线的拟合</h3>
<p>fitacis 函数实际上是 fitaci 函数的扩展，方便一次拟合多条曲线<a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a>。函数的参数如下：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fitacis</span>(data, group, <span class="dt">fitmethod =</span> <span class="kw">c</span>(<span class="st">&quot;default&quot;</span>, 
        <span class="st">&quot;bilinear&quot;</span>),<span class="dt">progressbar =</span> <span class="ot">TRUE</span>, 
        <span class="dt">quiet =</span> <span class="ot">FALSE</span>, <span class="dt">id =</span> <span class="ot">NULL</span>, ...)

## S3 method for class &#39;acifits&#39;
<span class="kw">plot</span>(x, <span class="dt">how =</span> <span class="kw">c</span>(<span class="st">&quot;manyplots&quot;</span>, <span class="st">&quot;oneplot&quot;</span>), 
     <span class="dt">highlight =</span> <span class="ot">NULL</span>, <span class="dt">ylim =</span> <span class="ot">NULL</span>, 
     <span class="dt">xlim =</span> <span class="ot">NULL</span>, <span class="dt">add =</span> <span class="ot">FALSE</span>, <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;model&quot;</span>,
     <span class="st">&quot;data&quot;</span>, <span class="st">&quot;none&quot;</span>), ...)</code></pre></div>
<p><strong>主要参数详解：</strong></p>
<p>实际上 fitacis 与 fitaci 模型算法完全一致，只不过增加了一个 group 参数，用于区分不同测量的数据，具体请参考举例内容。</p>
<div id="fitacis_exa" class="section level4">
<h4><span class="header-section-number">3.5.4.1</span> fitacis 函数应用举例</h4>
<p>下文代码根据 plantecophys 中的示例代码修改，进行演示，原代码请参考其帮助文档。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plantecophys)
<span class="co"># 只提取前10个不同测量的数据，节省时间进行举例</span>
manyacidat2 &lt;-<span class="st"> </span><span class="kw">droplevels</span>(manyacidat[manyacidat<span class="op">$</span>Curve <span class="op">%in%</span><span class="st"> </span>
<span class="st">                                       </span><span class="kw">levels</span>(manyacidat<span class="op">$</span>Curve)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>],])

<span class="co"># 对多条曲线进行拟合，使用bilinear方法，</span>
<span class="co"># 仅仅因为其比非线性拟合节省时间</span>
fits &lt;-<span class="st"> </span><span class="kw">fitacis</span>(manyacidat2, <span class="dt">group =</span> <span class="st">&quot;Curve&quot;</span>, <span class="dt">fitmethod=</span><span class="st">&quot;bilinear&quot;</span>)</code></pre></div>
<pre><code>## 
  |                                                        
  |                                                  |   0%
  |                                                        
  |=====                                             |  10%
  |                                                        
  |==========                                        |  20%
  |                                                        
  |===============                                   |  30%
  |                                                        
  |====================                              |  40%
  |                                                        
  |=========================                         |  50%
  |                                                        
  |==============================                    |  60%
  |                                                        
  |===================================               |  70%
  |                                                        
  |========================================          |  80%
  |                                                        
  |=============================================     |  90%
  |                                                        
  |==================================================| 100%</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 拟合结果为list，我们可以只提取第一个的拟合结果</span>
fits[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## Result of fitaci.
## 
## Data and predictions:
##            Ci      Ameas     Amodel         Ac        Aj   Ap        Rd
## 2    53.23129 -0.4401082  0.1014381  0.9601119  2.548123 1000 0.8586158
## 3    79.47367  2.4824630  2.1937702  3.0526198  7.036734 1000 0.8586158
## 4   116.74688  5.4531712  4.9419337  5.8011511 11.392394 1000 0.8586158
## 5   188.00801  9.7099879  9.5705964 10.4310194 16.447715 1000 0.8586158
## 6   278.44662 14.8225766 14.4261545 15.2897486 19.977583 1000 0.8586158
## 7   343.03259 17.7982155 17.4602014 18.3289218 21.639847 1000 0.8586158
## 1   344.72152 17.9244012 17.3165146 18.1849643 21.534276 1000 0.8586158
## 14  344.74839 16.7933747 17.6853306 18.5545917 21.774261 1000 0.8586158
## 8   588.08078 23.8925326 24.1309683 27.0327638 25.020148 3000 0.8586158
## 9   833.25547 26.5674409 25.7783026 33.0856065 26.647921 3000 0.8586158
## 10 1136.99222 25.9787890 26.8108335 38.1296944 27.676768 3000 0.8586158
## 11 1436.86370 26.6110657 27.5409345 42.0628463 28.405453 3000 0.8586158
## 12 1536.46772 27.4018784 27.7965881 43.3773689 28.660781 3000 0.8586158
## 13 1731.76400 28.6752069 28.0952804 45.2475932 28.959041 3000 0.8586158
##    VPD    Tleaf         Cc     PPFD Patm Ci_original
## 2  1.5 24.55873   53.23139 1799.959  100    53.23129
## 3  1.5 24.58292   79.47586 1799.590  100    79.47367
## 4  1.5 24.71278  116.75183 1799.819  100   116.74688
## 5  1.5 24.73687  188.01759 1800.371  100   188.00801
## 6  1.5 24.67508  278.46106 1800.233  100   278.44662
## 7  1.5 24.76596  343.05006 1799.575  100   343.03259
## 1  1.5 24.51593  344.73886 1800.356  100   344.72152
## 14 1.5 24.94098  344.76609 1799.964  100   344.74839
## 8  1.5 24.83785  588.10494 1799.477  100   588.08078
## 9  1.5 24.91185  833.28127 1799.969  100   833.25547
## 10 1.5 24.87314 1137.01906 1799.525  100  1136.99222
## 11 1.5 24.95914 1436.89126 1799.615  100  1436.86370
## 12 1.5 25.04542 1536.49554 1799.784  100  1536.46772
## 13 1.5 25.07566 1731.79212 1799.160  100  1731.76400
## 
## Root mean squared error:  2.196037 
## 
## Estimated parameters:
##          Estimate Std. Error
## Vcmax  65.0009909  1.3720635
## Jmax  131.7980133         NA
## Rd      0.8586158  0.2876248
## Note: Vcmax, Jmax are at 25C, Rd is at measurement T.
## 
## Curve was fit using method:  bilinear 
## 
## Parameter settings:
## Patm = 100
##  alpha = 0.24
##  theta = 0.85
##  EaV = 82620.87
##  EdVC = 0
##  delsC = 645.1013
##  EaJ = 39676.89
##  EdVJ = 2e+05
##  delsJ = 641.3615
## 
## Estimated from Tleaf (shown at mean Tleaf):
## GammaStar =  42.31453 
## Km =  698.2084</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 所有参数均可传递到 plot.acifit，例如：</span>
<span class="co"># 将所有的数据点作图，并将数据点标记为蓝色</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(fits, <span class="dt">how=</span><span class="st">&quot;oneplot&quot;</span>, <span class="dt">what=</span><span class="st">&quot;data&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">addlegend =</span> <span class="ot">FALSE</span>)
<span class="co"># 在上图的基础上增加模型拟合的线</span>
<span class="kw">plot</span>(fits, <span class="dt">how=</span><span class="st">&quot;oneplot&quot;</span>, <span class="dt">what=</span><span class="st">&quot;data&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">addlegend =</span> <span class="ot">FALSE</span>)
<span class="kw">plot</span>(fits, <span class="dt">how=</span><span class="st">&quot;oneplot&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">what=</span><span class="st">&quot;model&quot;</span>, <span class="dt">lwd=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">addlegend =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="figure"><span id="fig:fitacisr"></span>
<img src="bookdown_files/figure-html/fitacisr-1.png" alt="fitacis作图结果" width="672" />
<p class="caption">
图 3.3: fitacis作图结果
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 使用sapply提取拟合结果的RMSE(均方根误差)</span>
rmses &lt;-<span class="st"> </span><span class="kw">sapply</span>(fits, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;RMSE&quot;</span>)
<span class="kw">plot</span>(rmses, <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;RMSE&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Curve nr&quot;</span>)
<span class="co"># 对最差的拟合结果进行作图</span>
<span class="kw">plot</span>(fits[[<span class="kw">which.max</span>(rmses)]])</code></pre></div>
<div class="figure"><span id="fig:fitacisr"></span>
<img src="bookdown_files/figure-html/fitacisr-2.png" alt="fitacis作图结果" width="672" />
<p class="caption">
图 3.3: fitacis作图结果
</p>
</div>
<p>可以看出，<code>fitaci</code> 和 <code>fitacis</code> 用法基本一致，各行代码均已经注释，更详细用法请参函数考帮助。</p>
</div>
</div>
<div id="transition" class="section level3">
<h3><span class="header-section-number">3.5.5</span> <code>findCiTransition</code> 函数</h3>
<p>计算 CiTransition 的函数，第一点为 Ac &amp; Aj，第二点为 Aj &amp; Ap，并且仅在计算 TPU 的前提下才会有第二点出现。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">findCiTransition</span>(object, ...)</code></pre></div>
<p>参数使用，object 为 fitaci 函数对象，或者整个的 <code>Photosyn</code> 函数。 … 为使用 <code>Photosyn</code> 时可传递的参数。</p>
</div>
</div>
<div id="c4" class="section level2">
<h2><span class="header-section-number">3.6</span> C4 植物光合</h2>
<p>之前的部分模型全部为关于 C3 植物的拟合，而 <span class="citation">Caemmerer (<a href="#ref-Caemmerer2000Biochemical">2000</a>)</span> 的方法，则是针对 C4 植物的 A-Ci 曲线的实现。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">AciC4</span>(Ci, <span class="dt">PPFD =</span> <span class="dv">1500</span>, <span class="dt">Tleaf =</span> <span class="dv">25</span>, <span class="dt">VPMAX25 =</span> <span class="dv">120</span>, 
      <span class="dt">JMAX25 =</span> <span class="dv">400</span>, <span class="dt">Vcmax =</span> <span class="dv">60</span>, <span class="dt">Vpr =</span> <span class="dv">80</span>, 
      <span class="dt">alpha =</span> <span class="dv">0</span>, <span class="dt">gbs =</span> <span class="fl">0.003</span>, <span class="dt">O2 =</span> <span class="dv">210</span>, 
      <span class="dt">x =</span> <span class="fl">0.4</span>, <span class="dt">THETA =</span> <span class="fl">0.7</span>, <span class="dt">Q10 =</span> <span class="fl">2.3</span>, 
      <span class="dt">RD0 =</span> <span class="dv">1</span>, <span class="dt">RTEMP =</span> <span class="dv">25</span>, <span class="dt">TBELOW =</span> <span class="dv">0</span>, 
      <span class="dt">DAYRESP =</span> <span class="dv">1</span>, <span class="dt">Q10F =</span> <span class="dv">2</span>, <span class="dt">FRM =</span> <span class="fl">0.5</span>, ...)</code></pre></div>
<p><strong>参数详解</strong></p>
<ul>
<li>Ci：胞间二氧化碳浓度 (<span class="math inline">\(\mu mol\cdot m^{-2}\cdot s^{-1}\)</span>)。</li>
<li>PPFD：光合光量子通量密度 (<span class="math inline">\(\mu mol\cdot m^{-2}\cdot s^{-1}\)</span>)。</li>
<li>Tleaf：叶片温度 ()。</li>
<li>VPMAX25：PEP 羧化最大速率 (<span class="math inline">\(\mu mol\cdot m^{-2}\cdot s^{-1}\)</span>)。</li>
<li>JMAX25：最大电子传递速率 ())。</li>
<li>Vcmax：最大羧化速率(<span class="math inline">\(\mu mol\cdot m^{-2}\cdot s^{-1}\)</span>)。</li>
<li>Vpr：PEP 再生(<span class="math inline">\(\mu mol\cdot m^{-2}\cdot s^{-1}\)</span>)。</li>
<li>alpha：维管束鞘细胞中 PSII 活性的比例。</li>
<li>gbs：维管束鞘导度 (<span class="math inline">\(mol\cdot m^{-2}\cdot s^{-1}\)</span>)。</li>
<li>O2：叶肉细胞氧气浓度。</li>
<li>x：电子传递的分配因子。</li>
<li>THETA：曲角参数。</li>
<li>Q10：Michaelis-Menten 系数中依赖于温度的参数。</li>
<li>RD0：基温下的呼吸 (<span class="math inline">\(mol\cdot m^{-2}\cdot s^{-1}\)</span>)。</li>
<li>RTEMP：呼吸的基温()</li>
<li>TBELOW：此温度以下呼吸为0。</li>
<li>DAYRESP：明呼吸和暗呼吸的比值。</li>
<li>Q10F：呼吸依赖于温度的参数。</li>
<li>FRM：明呼吸中为叶肉呼吸的比例。</li>
</ul>
<p>以上参数均来自 <span class="citation">Caemmerer (<a href="#ref-Caemmerer2000Biochemical">2000</a>)</span>，括号中的参数值均为默认值，具体应用时请按照实际情况修改。</p>
<div id="c4_sim" class="section level3">
<h3><span class="header-section-number">3.6.1</span> C4 植物光合速率的计算</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 模拟 C4 植物的 Ci 值，计算光合速率并作图</span>
<span class="kw">library</span>(plantecophys)
aci &lt;-<span class="st"> </span><span class="kw">AciC4</span>(<span class="dt">Ci=</span><span class="kw">seq</span>(<span class="dv">5</span>,<span class="dv">600</span>, <span class="dt">length=</span><span class="dv">101</span>))
<span class="kw">with</span>(aci, <span class="kw">plot</span>(Ci, ALEAF, <span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">max</span>(ALEAF))))</code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-14"></span>
<img src="bookdown_files/figure-html/unnamed-chunk-14-1.png" alt="C4 植物 A-Ci 作图" width="672" />
<p class="caption">
图 3.4: C4 植物 A-Ci 作图
</p>
</div>


</div>
</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-Farquhar1980A">
<p>Farquhar, G. D., S. Von Caemmerer, and J. A. Berry. 1980. “A Biochemical Model of Photosynthetic Co<span class="math inline">\(_2\)</span> Assimilation in Leaves of C3 Species.” <em>Planta</em> 149 (1): 78–90.</p>
</div>
<div id="ref-Hikosaka2006Temperature">
<p>Hikosaka, K, K Ishikawa, A Borjigidai, O Muller, and Y Onoda. 2006. “Temperature Acclimation of Photosynthesis: Mechanisms Involved in the Changes in Temperature Dependence of Photosynthetic Rate.” <em>Journal of Experimental Botany</em> 57 (2): 291.</p>
</div>
<div id="ref-matthew2018">
<p>Haworth, Matthew, Giovanni Marino, and Mauro Centritto. 2018. “An Introductory Guide to Gas Exchange Analysis of Photosynthesis and Its Application to Plant Phenotyping and Precision Irrigation to Enhance Water Use Efficiency.” <em>Journal of Water and Climate Change</em>. doi:<a href="https://doi.org/https://doi.org/10.2166/wcc.2018.152">https://doi.org/10.2166/wcc.2018.152</a>.</p>
</div>
<div id="ref-Wullschleger1993Biochemical">
<p>Wullschleger, Stan D. 1993. “Biochemical Limitations to Carbon Assimilation in C3 Plants—A Retrospective Analysis of the a-Ci Curves from 109 Species.” <em>Journal of Experimental Botany</em> 44 (262): 907–20.</p>
</div>
<div id="ref-Long2003Gas">
<p>Long, S. P., and C. J. Bernacchi. 2003. “Gas Exchange Measurements, What Can They Tell Us About the Underlying Limitations to Photosynthesis? Procedures and Sources of Error.” <em>Journal of Experimental Botany</em> 54 (392): 2393.</p>
</div>
<div id="ref-heath2005rising">
<p>Heath, James R, Edward Ayres, Malcolm Possell, Richard D Bardgett, Helaina I J Black, Helen Grant, Phil Ineson, and Gerhard Kerstiens. 2005. “Rising Atmospheric Co2 Reduces Sequestration of Root-Derived Soil Carbon.” <em>Science</em> 309 (5741): 1711–3.</p>
</div>
<div id="ref-marshall1980a">
<p>Marshall, B, and P V Biscoe. 1980. “A Model for C3 Leaves Describing the Dependence of Net Photosynthesis on Irradiance.” <em>Journal of Experimental Botany</em> 31 (1): 29–39.</p>
</div>
<div id="ref-ellsworth2015phosphorus">
<p>Ellsworth, David S, Kristine Y Crous, Hans Lambers, and Julia Cooke. 2015. “Phosphorus Recycling in Photorespiration Maintains High Photosynthetic Capacity in Woody Species.” <em>Plant Cell and Environment</em> 38 (6): 1142–56.</p>
</div>
<div id="ref-centritto2003">
<p>Centritto, M, F Loreto, and K Chartzoulakis. 2003. “The Use of Low Co2 to Estimate Diffusional and Non-Diffusional Limitations of Photosynthetic Capacity of Salt-Stressed Olive Saplings.” <em>Plant Cell and Environment</em> 26 (4): 585–94.</p>
</div>
<div id="ref-lauteri2014">
<p>Lauteri, Marco, Matthew Haworth, Rachid Serraj, Maria Cristina Monteverdi, and Mauro Centritto. 2014. “Photosynthetic Diffusional Constraints Affect Yield in Drought Stressed Rice Cultivars During Flowering.” <em>PLOS ONE</em> 9 (10).</p>
</div>
<div id="ref-Aganchich2009">
<p>Aganchich, B, S Wahbi, F Loreto, and M Centritto. 2009. “Partial Root Zone Drying: Regulation of Photosynthetic Limitations and Antioxidant Enzymatic Activities in Young Olive (Olea Europaea) Saplings.” <em>Tree Physiology</em> 29 (5): 685.</p>
</div>
<div id="ref-haworth2015coordination">
<p>Haworth, Matthew, Dilek Killi, Alessandro Materassi, and Antonio Raschi. 2015. “Coordination of Stomatal Physiological Behavior and Morphology with Carbon Dioxide Determines Stomatal Control.” <em>American Journal of Botany</em> 102 (5): 677–88.</p>
</div>
<div id="ref-yin2009using">
<p>Yin, Xinyou, P C Struik, Pascual Romero, Jeremy Harbinson, Jochem B Evers, Peter E L Van Der Putten, and J Vos. 2009. “Using Combined Measurements of Gas Exchange and Chlorophyll Fluorescence to Estimate Parameters of a Biochemical C3 Photosynthesis Model: A Critical Appraisal and a New Integrated Approach Applied to Leaves in a Wheat (Triticum Aestivum) Canopy.” <em>Plant Cell and Environment</em> 32 (5): 448–64.</p>
</div>
<div id="ref-Flexas2007leak">
<p>Flexas J, Azespejo A, and Berry J A. 2007. “Analysis of Leakage in Irga’s Leaf Chambers of Open Gas Exchange Systems: Quantification and Its Effects in Photosynthesis Parameterization.” <em>Journal of Experimental Botany</em> 58 (6): 1533.</p>
</div>
<div id="ref-Duursma2015Plantecophys">
<p>Duursma, Remko A. 2015. “Plantecophys-an R Package for Analysing and Modelling Leaf Gas Exchange Data.” <em>Plos One</em> 10 (11): e0143346.</p>
</div>
<div id="ref-Medlyn2002Temperature">
<p>Medlyn, B. E, E Dreyer, D Ellsworth, M Forstreuter, P. C Harley, M. U. F Kirschbaum, X Le Roux, P Montpied, J Strassemeyer, and A Walcroft. 2002. “Temperature Response of Parameters of a Biochemically Based Model of Photosynthesis. Ii. a Review of Experimental Data Review.” <em>Plant Cell &amp; Environment</em> 25 (9): 1167–79.</p>
</div>
<div id="ref-Gu2010Reliable">
<p>Gu, Lianhong, Stephen G Pallardy, Kevin Tu, Beverly E Law, and Stan D Wullschleger. 2010. “Reliable Estimation of Biochemical Parameters from c-3 Leaf Photosynthesis-Intercellular Carbon Dioxide Response Curves.” <em>Plant Cell &amp; Environment</em> 33 (11): 1852–74.</p>
</div>
<div id="ref-De2016A">
<p>De Kauwe, Martin G, Yan Shih Lin, Ian J Wright, Belinda E Medlyn, Kristine Y Crous, David S Ellsworth, Vincent Maire, I Colin Prentice, Owen K Atkin, and Alistair Rogers. 2016. “A Test of the One Point Method for Estimating Maximum Carboxlation Capacity from Field Measured, Light Saturated Photosynthesis.” <em>New Phytologist</em> 210 (3): 1130.</p>
</div>
<div id="ref-Caemmerer2000Biochemical">
<p>Caemmerer, S. Von. 2000. “Biochemical Models of Leaf Photosynthesis.” <em>Quarterly Review of Biology</em>, 165.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>仅针对 C3 植物<a href="response-fit.html#fnref3">↩</a></p></li>
<li id="fn4"><p>具体参考 R 语言相关文档，为 R 语言最常用的数据格式<a href="response-fit.html#fnref4">↩</a></p></li>
<li id="fn5"><p>在 R 中，使用参数的值为默认值时可以不用填写该参数，例如使用默认选项分析 LI-6400 数据时，可只填写 data 项，具体参考 R 的相关入门手册<a href="response-fit.html#fnref5">↩</a></p></li>
<li id="fn6"><p>为Rubisco和RuBP限制的Ci转换点，物种间差异较大，可以通过预实验确定<a href="response-fit.html#fnref6">↩</a></p></li>
<li id="fn7"><p>若默认拟合方法失败，数据也无问题，那么是非线性拟合初始值设定的原因<a href="response-fit.html#fnref7">↩</a></p></li>
<li id="fn8"><p>即仅保留测量值，删除其他所有头文件、空行、 remark 等信息<a href="response-fit.html#fnref8">↩</a></p></li>
<li id="fn9"><p>首次使用安装，更换电脑或者升级 R 软件后，如果没有拷贝 library，也需要运行安装命令<a href="response-fit.html#fnref9">↩</a></p></li>
<li id="fn10"><p>需要注意，此时fitmethod一般推荐使用bilinear。<a href="response-fit.html#fnref10">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="batch-question.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stomotal-sim.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-crc/edit/master/02-fvcb.Rmd",
"text": "缂栬緫"
},
"download": ["bookdown.pdf", "bookdown.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
